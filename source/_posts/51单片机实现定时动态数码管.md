---
title: 51单片机实现定时动态数码管
tags: [单片机]
categories: [硬件,单片机,51]
date: 2019-10-03 19:25:44
---
#### 0. 开发环境

> 单片机: stc89c52
>
> 开发板: Hot51单片机增强版

#### 1. 电路图

![](https://raw.githubusercontent.com/qnyt1993/picture/master/img/2019/10/01/QQ%E6%88%AA%E5%9B%BE20191003135722.png)

![](https://raw.githubusercontent.com/qnyt1993/picture/master/img/2019/10/01/QQ%E6%88%AA%E5%9B%BE20191003135742.png)

#### 3. 程序代码

    #include<Reg52.h>
    #define uchar unsigned char
    #define uint unsigned int
    
    uchar code LedChar[]= { 																//数码管字符编码数组
    
        0x3F,  //"0"
        0x06,  //"1"
        0x5B,  //"2"
        0x4F,  //"3"
        0x66,  //"4"
        0x6D,  //"5"
        0x7D,  //"6"
        0x07,  //"7"
        0x7F,  //"8"
        0x6F,  //"9"
        0x77,  //"A"
        0x7C,  //"B"
        0x39,  //"C"
        0x5E,  //"D"
        0x79,  //"E"
        0x71	 // "F"
    };
    
    uchar code LedWei[] = {7,6,5,4,3,2,1,0 };														//八位数码管的位置值
    uchar LedBuff[] = {0x3F, 0x3F, 0x3F, 0x3F, 0x3F, 0x3F, 0x3F, 0x3F};	//八位数码管应该显示的值
    uint count = 0; //定义一个计数初值
    uchar i = 0;
    
    void main() {
    
        uint sec = 0;   //定义当前应该显示字符的索引位置
    
        EA = 1;
        TMOD = 0x01;	//设置定时器0为一个16位的定时器
        TH0 = 0xFC;		//因为定时器分高八位和低八位，根据累加到溢出从而实现定时，因此需要给定时器0设置累加初值
        TL0 = 0x66;		//设置每次定时1ms
        ET0 = 1;
        TR0 = 1;			//开启定时器
    
        while(1) {
            if(count >= 1000) {
                count = 0;
    
                sec++;
    
                LedBuff[0] = LedChar[sec%10];		//计算当前八位数码管每个位置应该显示的值
                LedBuff[1] = LedChar[sec/10%10];
                LedBuff[2] = LedChar[sec/100%10];
                LedBuff[3] = LedChar[sec/1000%10];
                LedBuff[4] = LedChar[sec/10000%10];
                LedBuff[5] = LedChar[sec/100000%10];
                LedBuff[6] = LedChar[sec/1000000%10];
                LedBuff[7] = LedChar[sec/10000000%10];
    
            }
    
        }
    }
    
    void InterruptTimer0()  interrupt 1		//定时器0触发的中断
    {
        TH0 = 0xFC;			//重新设置定时器0的初始值
        TL0 = 0x66;
    
        P2 = LedWei[i];		//设置显示当前需要展示的位置
    
        P0 = LedBuff[i];	//设置当前要展示的值
        count++;
    
        if(i == 7) {
            i = 0;
        } else {
            i++;
        }
    
    }
           
    
#### 4. 效果演示

<iframe src="//player.bilibili.com/player.html?aid=69886245&cid=121099021&page=1" 
 width=100% 
  height=600 
scrolling="no" 
border="0" 
frameborder="no" 
framespacing="0" 
allowfullscreen="true"> 
</iframe>

    