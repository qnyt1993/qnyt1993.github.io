---
title: 51单片机定时闪烁灯
tags: [单片机]
categories: [硬件,单片机,51]
date: 2019-10-01 10:40:35
---
#### 0. 开发环境
> 单片机: stc89c52
> 开发板: 清翔单片机(QX-MCS51 V2.0)

#### 1. 定时器存储寄存器

>时钟周期：单片机时序中的最小单位，具体计算的方法就是时钟源分之一。

>机器周期：我们的单片机完成一个操作的最短时间。

>定时器：打开定时器后，定时器"存储寄存器"的值经过一个机器周期自动加1，也就是说，机器周期是定时器的计数周期
![](https://raw.githubusercontent.com/qnyt1993/picture/master/img/2019/09/27/QQ%E6%88%AA%E5%9B%BE20191001124645.png)

![](https://raw.githubusercontent.com/qnyt1993/picture/master/img/2019/10/01/QQ%E6%88%AA%E5%9B%BE20191001124802.png)

![](https://raw.githubusercontent.com/qnyt1993/picture/master/img/2019/10/01/QQ%E6%88%AA%E5%9B%BE20191001124848.png)

![](https://raw.githubusercontent.com/qnyt1993/picture/master/img/2019/10/01/QQ%E6%88%AA%E5%9B%BE20191001124927.png)

#### 2. 使用定时器的方法

    第一：设置特殊功能寄存器TMOD，配置好工作模式。
    
    第二：设置计数寄存器TH0和TL0的初值。
    
    第三：设置TCON，通过TR0置1来让定时器开始计数。
    
    第四：判断TCON寄存器的TF0位，监测定时器溢出情况
    
    
 #### 3. 代码实现
 
     #include<Reg52.h>
     #define uchar unsigned char
     
     sbit LED = P1^0;
     
     //实现1s闪烁灯
     void main() {
         uchar count = 0; //定义一个计数初值
     
         TMOD = 0x01;	    //设置定时器0为一个16位的定时器
         TH0 = 0xB8;		//因为定时器分高八位和低八位，根据累加到溢出从而实现定时，因此需要给定时器0设置累加初值
         TL0 = 0x00;		//1011 1000 0000 0000 等于十进制的134000 ,x*12/11059200 = 0.02 x=18432 设置初始值为65536-18432 = 47104 转为16进制就是B800
         TR0 = 1;			//开启定时器
     
         while(1) {
             if(TF0 == 1) {
                 TF0 = 0;		//清除定时器0溢出
                 TH0 = 0xB8;	//重新设置定时器0的初始累加值
                 TL0 = 0x00;
                 count++;
                 if(count >= 50) {
                     count = 0;
                     LED = ~LED;
                 }
             }
         }
     }   
     
<iframe src="//player.bilibili.com/player.html?aid=69633830&cid=120678978&page=1"
 width=100% 
  height=600
 scrolling="no"
  border="0" 
  frameborder="no"
   framespacing="0" 
   allowfullscreen="true"> </iframe>    